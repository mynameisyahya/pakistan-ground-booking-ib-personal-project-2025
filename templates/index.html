{% extends "base.html" %}

{% block title %}PlayNow - Find a game{% endblock %}

{% block extra_css %}
<style>
    /* Light, punchy Pakistan-inspired theme */
    :root{--pk-green:#0aa34f; --pk-deep:#0b6b3a; --pk-gold:#ffb703; --muted:#6b7280; --paper:#f7f8fc; --card:#ffffff}
    .hero{padding:56px 0 16px}
    .hero h1{font-weight:900;letter-spacing:.2px;color:var(--pk-deep)}
    .row-scroller{display:grid;grid-auto-flow:column;grid-auto-columns:calc(33% - 14px);gap:18px;overflow-x:auto;padding-bottom:10px;scroll-snap-type:x mandatory}
    .row-scroller::-webkit-scrollbar{display:none}
    .match-card{background:var(--card);border:1px solid rgba(0,0,0,.06);border-radius:20px;overflow:hidden;transition:transform .2s ease, box-shadow .2s ease;scroll-snap-align:start;box-shadow:0 16px 40px rgba(16,24,40,.08)}
    .match-card:hover{transform:translateY(-4px);box-shadow:0 20px 50px rgba(16,24,40,.12)}
    .match-thumb{height:260px;object-fit:cover;width:100%}
    .match-body{padding:14px}
    .muted{color:var(--muted)}
    .option-card{background:#fff;border:1px solid rgba(0,0,0,.06);border-radius:16px;padding:16px 18px;display:flex;align-items:center;gap:12px;color:#111827;text-decoration:none;box-shadow:0 10px 30px rgba(16,24,40,.08)}
    .option-card:hover{background:#f9fafb}
    .pills .btn{border-radius:999px}
    .pill-light{background:#e8f5ee;border:none;color:var(--pk-deep)}
    @media (max-width:900px){.row-scroller{grid-auto-columns:80%}}
</style>
{% endblock %}

{% block content %}
<div class="app-container">
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="mt-3">
                {% for category, message in messages %}
                    <div class="alert alert-{{ 'danger' if category == 'danger' else 'success' }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <div class="hero">
        <h1>Find a game. Join instantly.</h1>
        <div class="muted mb-3">Browse live matches across grounds. Log in only when you hit join.</div>
        <div class="d-flex gap-2 pills mb-3">
            <button class="btn pill-light btn-sm">Football</button>
            <button class="btn pill-light btn-sm">Cricket</button>
            <button class="btn pill-light btn-sm">Trending</button>
        </div>
        {% if lobby_cards %}
        <h5 class="mb-2">Ongoing games</h5>
        <div class="row-scroller mb-4">
            {% for c in lobby_cards %}
            <div class="match-card">
                <img class="match-thumb" src="{{ c.ground.img or 'https://images.unsplash.com/photo-1521417531135-83b3ed1d83a1?auto=format&fit=crop&w=1200&q=60' }}" alt="{{ c.ground.name }}">
                <div class="match-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="fw-bold">{{ c.ground.name }}</div>
                            <div class="muted small">{{ c.ground.location }} ‚Ä¢ {{ c.match.date }} {{ c.match.time }}</div>
                            <div class="muted small">{{ c.count }}/{{ c.capacity }} joined</div>
                        </div>
                        <div>
                            <a class="btn btn-primary btn-sm cta" href="{{ url_for('grounds') }}">View</a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% endif %}
        <div class="d-flex gap-2">
            <a href="{{ url_for('grounds') }}" class="btn btn-primary">Browse grounds</a>
            {% if not session.get('user_type') %}
            <a href="{{ url_for('signup_player') }}" class="option-card">üë§ <span>Sign up as player</span></a>
            <a href="{{ url_for('signup_host') }}" class="option-card">üèüÔ∏è <span>Sign up as host</span></a>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}